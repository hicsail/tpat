{"ast":null,"code":"var _jsxFileName = \"/Users/so._.may._.see._.macy/tpat/src/components/MainRecorder/MainRecorder.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { memo, useState } from \"react\";\nimport { Box, Icon, Button, useTheme, SimpleGrid, IconButton } from \"@chakra-ui/react\";\nimport { FaVideoSlash, FaDownload, FaCamera } from \"react-icons/fa\";\nimport \"video-react/dist/video-react.css\"; // @ts-ignore\n\nimport { Player } from \"video-react\"; // @ts-ignore\n\nimport RecordRTC, { invokeSaveAsDialog, // @ts-ignore\nRecordRTCPromisesHandler } from \"recordrtc\";\nimport { saveAs } from \"file-saver\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MainRecorder = () => {\n  _s();\n\n  const theme = useTheme();\n  const [recorder, setRecorder] = useState();\n  const [stream, setStream] = useState();\n  const [videoBlob, setVideoUrlBlob] = useState();\n  const [type, setType] = useState(\"video\");\n\n  const startRecording = async () => {\n    let stream = await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    });\n    let recorder = new RecordRTCPromisesHandler(stream, {\n      type: \"video\"\n    });\n    recorder.startRecording();\n\n    const sleep = m => new Promise(r => setTimeout(r, m));\n\n    await sleep(3000);\n    await recorder.stopRecording();\n    let blob = await recorder.getBlob();\n    invokeSaveAsDialog(blob);\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(async function (stream) {\n      let recorder = RecordRTC(stream, {\n        type: \"video\"\n      });\n      recorder.startRecording();\n\n      const sleep = m => new Promise(r => setTimeout(r, m));\n\n      await sleep(3000);\n      recorder.stopRecording(function () {\n        let blob = recorder.getBlob();\n        invokeSaveAsDialog(blob);\n      });\n    });\n  };\n\n  const stopRecording = async () => {\n    if (recorder) {\n      await recorder.stopRecording();\n      const blob = await recorder.getBlob();\n      stream.stop();\n      setVideoUrlBlob(blob);\n      setStream(null);\n      setRecorder(null);\n    }\n  };\n\n  const downloadVideo = () => {\n    if (videoBlob) {\n      const mp4File = new File([videoBlob], \"demo.mp4\", {\n        type: \"video/mp4\"\n      });\n      saveAs(mp4File, `Video-${Date.now()}.mp4`); // saveAs(videoBlob, `Video-${Date.now()}.webm`)\n    }\n  };\n\n  const changeType = () => {\n    if (type === \"screen\") {\n      setType(\"video\");\n    } else {\n      setType(\"screen\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(SimpleGrid, {\n    spacing: \"5\",\n    p: \"5\",\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      flexDirection: [\"column\", // 0-30em\n      \"row\", // 30em-48em\n      \"row\", // 48em-62em\n      \"row\" // 62em+\n      ],\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        m: \"1\",\n        bg: theme.colors.blue[600],\n        size: \"lg\",\n        \"aria-label\": \"start recording\",\n        color: \"white\",\n        onClick: changeType,\n        children: type === \"screen\" ? \"Record Screen\" : \"Record Video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        m: \"1\",\n        bg: theme.colors.blue[600],\n        size: \"lg\",\n        \"aria-label\": \"start recording\",\n        color: \"white\",\n        onClick: startRecording,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          as: FaCamera\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        m: \"1\",\n        bg: theme.colors.blue[600],\n        size: \"lg\",\n        color: \"white\",\n        \"aria-label\": \"stop recording\",\n        onClick: stopRecording,\n        disabled: recorder ? false : true,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          as: FaVideoSlash\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        bg: theme.colors.blue[600],\n        m: \"1\",\n        size: \"lg\",\n        disabled: !!!videoBlob,\n        color: \"white\",\n        onClick: downloadVideo,\n        \"aria-label\": \"download video\",\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          as: FaDownload\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        bg: !!videoBlob ? \"inherit\" : \"blue.50\",\n        h: \"50vh\",\n        width: [\"100%\", // 0-30em\n        \"100%\", // 30em-48em\n        \"50vw\", // 48em-62em\n        \"50vw\" // 62em+\n        ],\n        children: !!videoBlob && /*#__PURE__*/_jsxDEV(Player, {\n          src: window.URL.createObjectURL(videoBlob)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MainRecorder, \"BvvENKzqZTBP9OPqigGgNXtAm5g=\", false, function () {\n  return [useTheme];\n});\n\n_c = MainRecorder;\nexport default _c2 = /*#__PURE__*/memo(MainRecorder);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MainRecorder\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","memo","useState","Box","Icon","Button","useTheme","SimpleGrid","IconButton","FaVideoSlash","FaDownload","FaCamera","Player","RecordRTC","invokeSaveAsDialog","RecordRTCPromisesHandler","saveAs","MainRecorder","theme","recorder","setRecorder","stream","setStream","videoBlob","setVideoUrlBlob","type","setType","startRecording","navigator","mediaDevices","getUserMedia","video","audio","sleep","m","Promise","r","setTimeout","stopRecording","blob","getBlob","then","stop","downloadVideo","mp4File","File","Date","now","changeType","colors","blue","window","URL","createObjectURL"],"sources":["/Users/so._.may._.see._.macy/tpat/src/components/MainRecorder/MainRecorder.tsx"],"sourcesContent":["import React, { FC, memo, useState } from \"react\";\nimport {\n  Box,\n  Icon,\n  Theme,\n  Button,\n  useTheme,\n  SimpleGrid,\n  IconButton,\n} from \"@chakra-ui/react\";\nimport { FaVideoSlash, FaDownload, FaCamera } from \"react-icons/fa\";\nimport \"video-react/dist/video-react.css\";\n// @ts-ignore\nimport { Player } from \"video-react\";\n// @ts-ignore\nimport RecordRTC, {\n  invokeSaveAsDialog,\n  // @ts-ignore\n  RecordRTCPromisesHandler,\n} from \"recordrtc\";\nimport { saveAs } from \"file-saver\";\n\nconst MainRecorder: FC = () => {\n  const theme: Theme = useTheme();\n  const [recorder, setRecorder] = useState<RecordRTC | null>();\n  const [stream, setStream] = useState<MediaStream | null>();\n  const [videoBlob, setVideoUrlBlob] = useState<Blob | null>();\n  const [type, setType] = useState<\"video\" | \"screen\">(\"video\");\n\n  const startRecording = async () => {\n    let stream = await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true,\n    });\n    let recorder = new RecordRTCPromisesHandler(stream, {\n      type: \"video\",\n    });\n    recorder.startRecording();\n\n    const sleep = (m: number | undefined) =>\n      new Promise((r) => setTimeout(r, m));\n    await sleep(3000);\n\n    await recorder.stopRecording();\n    let blob = await recorder.getBlob();\n    invokeSaveAsDialog(blob);\n\n    navigator.mediaDevices\n      .getUserMedia({\n        video: true,\n        audio: true,\n      })\n      .then(async function (stream) {\n        let recorder = RecordRTC(stream, {\n          type: \"video\",\n        });\n        recorder.startRecording();\n\n        const sleep = (m) => new Promise((r) => setTimeout(r, m));\n        await sleep(3000);\n\n        recorder.stopRecording(function () {\n          let blob = recorder.getBlob();\n          invokeSaveAsDialog(blob);\n        });\n      });\n  };\n\n  const stopRecording = async () => {\n    if (recorder) {\n      await recorder.stopRecording();\n      const blob: Blob = await recorder.getBlob();\n      (stream as any).stop();\n      setVideoUrlBlob(blob);\n      setStream(null);\n      setRecorder(null);\n    }\n  };\n\n  const downloadVideo = () => {\n    if (videoBlob) {\n      const mp4File = new File([videoBlob], \"demo.mp4\", { type: \"video/mp4\" });\n      saveAs(mp4File, `Video-${Date.now()}.mp4`);\n      // saveAs(videoBlob, `Video-${Date.now()}.webm`)\n    }\n  };\n\n  const changeType = () => {\n    if (type === \"screen\") {\n      setType(\"video\");\n    } else {\n      setType(\"screen\");\n    }\n  };\n\n  return (\n    <SimpleGrid spacing=\"5\" p=\"5\">\n      <Box\n        display=\"flex\"\n        justifyContent=\"center\"\n        flexDirection={[\n          \"column\", // 0-30em\n          \"row\", // 30em-48em\n          \"row\", // 48em-62em\n          \"row\", // 62em+\n        ]}\n      >\n        <Button\n          m=\"1\"\n          bg={theme.colors.blue[600]}\n          size=\"lg\"\n          aria-label=\"start recording\"\n          color=\"white\"\n          onClick={changeType}\n        >\n          {type === \"screen\" ? \"Record Screen\" : \"Record Video\"}\n        </Button>\n        <IconButton\n          m=\"1\"\n          bg={theme.colors.blue[600]}\n          size=\"lg\"\n          aria-label=\"start recording\"\n          color=\"white\"\n          onClick={startRecording}\n          icon={<Icon as={FaCamera} />}\n        />\n        <IconButton\n          m=\"1\"\n          bg={theme.colors.blue[600]}\n          size=\"lg\"\n          color=\"white\"\n          aria-label=\"stop recording\"\n          onClick={stopRecording}\n          disabled={recorder ? false : true}\n          icon={<Icon as={FaVideoSlash} />}\n        />\n        <IconButton\n          bg={theme.colors.blue[600]}\n          m=\"1\"\n          size=\"lg\"\n          disabled={!!!videoBlob}\n          color=\"white\"\n          onClick={downloadVideo}\n          aria-label=\"download video\"\n          icon={<Icon as={FaDownload} />}\n        />\n      </Box>\n      <Box display=\"flex\" justifyContent=\"center\">\n        <Box\n          bg={!!videoBlob ? \"inherit\" : \"blue.50\"}\n          h=\"50vh\"\n          width={[\n            \"100%\", // 0-30em\n            \"100%\", // 30em-48em\n            \"50vw\", // 48em-62em\n            \"50vw\", // 62em+\n          ]}\n        >\n          {!!videoBlob && (\n            <Player src={window.URL.createObjectURL(videoBlob)} />\n          )}\n        </Box>\n      </Box>\n    </SimpleGrid>\n  );\n};\n\nexport default memo(MainRecorder);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}