{"ast":null,"code":"var _jsxFileName = \"/Users/so._.may._.see._.macy/tpat/src/components/MainRecorder/MainRecorder.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { memo, useState } from \"react\";\nimport { Box, Icon, Button, useTheme, SimpleGrid, IconButton } from \"@chakra-ui/react\";\nimport { FaVideoSlash, FaDownload, FaCamera } from \"react-icons/fa\";\nimport \"video-react/dist/video-react.css\"; // @ts-ignore\n\nimport { Player } from \"video-react\"; // @ts-ignore\n\nimport RecordRTC, { invokeSaveAsDialog } from \"recordrtc\";\nimport { saveAs } from \"file-saver\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MainRecorder = () => {\n  _s();\n\n  const theme = useTheme();\n  const [recorder, setRecorder] = useState();\n  const [stream, setStream] = useState();\n  const [videoBlob, setVideoUrlBlob] = useState();\n  const [type, setType] = useState(\"video\");\n\n  const startRecording = async () => {\n    const stream = type === \"video\" ? await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }) : await navigamediaDevices.getDisplayMedia({\n      video: true,\n      audio: false\n    }).then(async function (stream) {\n      let recorder = new RecordRTC(stream, {\n        type: \"video\"\n      });\n      recorder.startRecording();\n\n      const sleep = m => new Promise(r => setTimeout(r, m));\n\n      await sleep(3000);\n      recorder.stopRecording(function () {\n        let blob = recorder.getBlob();\n        invokeSaveAsDialog(blob);\n      });\n    });\n  };\n\n  const stopRecording = async () => {\n    if (recorder) {\n      await recorder.stopRecording();\n      const blob = await recorder.getBlob();\n      stream.stop();\n      setVideoUrlBlob(blob);\n      setStream(null);\n      setRecorder(null);\n    }\n  };\n\n  const downloadVideo = () => {\n    if (videoBlob) {\n      const mp4File = new File([videoBlob], \"demo.mp4\", {\n        type: \"video/mp4\"\n      });\n      saveAs(mp4File, `Video-${Date.now()}.mp4`); // saveAs(videoBlob, `Video-${Date.now()}.webm`)\n    }\n  };\n\n  const changeType = () => {\n    if (type === \"screen\") {\n      setType(\"video\");\n    } else {\n      setType(\"screen\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(SimpleGrid, {\n    spacing: \"5\",\n    p: \"5\",\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      flexDirection: [\"column\", // 0-30em\n      \"row\", // 30em-48em\n      \"row\", // 48em-62em\n      \"row\" // 62em+\n      ],\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        m: \"1\",\n        bg: theme.colors.blue[600],\n        size: \"lg\",\n        \"aria-label\": \"start recording\",\n        color: \"white\",\n        onClick: changeType,\n        children: type === \"screen\" ? \"Record Screen\" : \"Record Video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        m: \"1\",\n        bg: theme.colors.blue[600],\n        size: \"lg\",\n        \"aria-label\": \"start recording\",\n        color: \"white\",\n        onClick: startRecording,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          as: FaCamera\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        m: \"1\",\n        bg: theme.colors.blue[600],\n        size: \"lg\",\n        color: \"white\",\n        \"aria-label\": \"stop recording\",\n        onClick: stopRecording,\n        disabled: recorder ? false : true,\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          as: FaVideoSlash\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        bg: theme.colors.blue[600],\n        m: \"1\",\n        size: \"lg\",\n        disabled: !!!videoBlob,\n        color: \"white\",\n        onClick: downloadVideo,\n        \"aria-label\": \"download video\",\n        icon: /*#__PURE__*/_jsxDEV(Icon, {\n          as: FaDownload\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        bg: !!videoBlob ? \"inherit\" : \"blue.50\",\n        h: \"50vh\",\n        width: [\"100%\", // 0-30em\n        \"100%\", // 30em-48em\n        \"50vw\", // 48em-62em\n        \"50vw\" // 62em+\n        ],\n        children: !!videoBlob && /*#__PURE__*/_jsxDEV(Player, {\n          src: window.URL.createObjectURL(videoBlob)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MainRecorder, \"BvvENKzqZTBP9OPqigGgNXtAm5g=\", false, function () {\n  return [useTheme];\n});\n\n_c = MainRecorder;\nexport default _c2 = /*#__PURE__*/memo(MainRecorder);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MainRecorder\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","memo","useState","Box","Icon","Button","useTheme","SimpleGrid","IconButton","FaVideoSlash","FaDownload","FaCamera","Player","RecordRTC","invokeSaveAsDialog","saveAs","MainRecorder","theme","recorder","setRecorder","stream","setStream","videoBlob","setVideoUrlBlob","type","setType","startRecording","navigator","mediaDevices","getUserMedia","video","audio","navigamediaDevices","getDisplayMedia","then","sleep","m","Promise","r","setTimeout","stopRecording","blob","getBlob","stop","downloadVideo","mp4File","File","Date","now","changeType","colors","blue","window","URL","createObjectURL"],"sources":["/Users/so._.may._.see._.macy/tpat/src/components/MainRecorder/MainRecorder.tsx"],"sourcesContent":["import React, { FC, memo, useState } from \"react\";\nimport {\n  Box,\n  Icon,\n  Theme,\n  Button,\n  useTheme,\n  SimpleGrid,\n  IconButton,\n} from \"@chakra-ui/react\";\nimport { FaVideoSlash, FaDownload, FaCamera } from \"react-icons/fa\";\nimport \"video-react/dist/video-react.css\";\n// @ts-ignore\nimport { Player } from \"video-react\";\n// @ts-ignore\nimport RecordRTC, {\n  invokeSaveAsDialog,\n  // @ts-ignore\n  RecordRTCPromisesHandler,\n} from \"recordrtc\";\nimport { saveAs } from \"file-saver\";\n\nconst MainRecorder: FC = () => {\n  const theme: Theme = useTheme();\n  const [recorder, setRecorder] = useState<RecordRTC | null>();\n  const [stream, setStream] = useState<MediaStream | null>();\n  const [videoBlob, setVideoUrlBlob] = useState<Blob | null>();\n  const [type, setType] = useState<\"video\" | \"screen\">(\"video\");\n\n  const startRecording = async () => {\n    const stream: MediaStream =\n      type === \"video\"\n        ? await navigator.mediaDevices.getUserMedia({\n            video: true,\n            audio: true,\n          })\n        : await (navigamediaDevices as any)\n            .getDisplayMedia({ video: true, audio: false })\n            .then(async function (stream) {\n              let recorder = new RecordRTC(stream, {\n                type: \"video\",\n              });\n              recorder.startRecording();\n\n              const sleep = (m: number | undefined) =>\n                new Promise((r) => setTimeout(r, m));\n              await sleep(3000);\n\n              recorder.stopRecording(function () {\n                let blob = recorder.getBlob();\n                invokeSaveAsDialog(blob);\n              });\n            });\n  };\n\n  const stopRecording = async () => {\n    if (recorder) {\n      await recorder.stopRecording();\n      const blob: Blob = await recorder.getBlob();\n      (stream as any).stop();\n      setVideoUrlBlob(blob);\n      setStream(null);\n      setRecorder(null);\n    }\n  };\n\n  const downloadVideo = () => {\n    if (videoBlob) {\n      const mp4File = new File([videoBlob], \"demo.mp4\", { type: \"video/mp4\" });\n      saveAs(mp4File, `Video-${Date.now()}.mp4`);\n      // saveAs(videoBlob, `Video-${Date.now()}.webm`)\n    }\n  };\n\n  const changeType = () => {\n    if (type === \"screen\") {\n      setType(\"video\");\n    } else {\n      setType(\"screen\");\n    }\n  };\n\n  return (\n    <SimpleGrid spacing=\"5\" p=\"5\">\n      <Box\n        display=\"flex\"\n        justifyContent=\"center\"\n        flexDirection={[\n          \"column\", // 0-30em\n          \"row\", // 30em-48em\n          \"row\", // 48em-62em\n          \"row\", // 62em+\n        ]}\n      >\n        <Button\n          m=\"1\"\n          bg={theme.colors.blue[600]}\n          size=\"lg\"\n          aria-label=\"start recording\"\n          color=\"white\"\n          onClick={changeType}\n        >\n          {type === \"screen\" ? \"Record Screen\" : \"Record Video\"}\n        </Button>\n        <IconButton\n          m=\"1\"\n          bg={theme.colors.blue[600]}\n          size=\"lg\"\n          aria-label=\"start recording\"\n          color=\"white\"\n          onClick={startRecording}\n          icon={<Icon as={FaCamera} />}\n        />\n        <IconButton\n          m=\"1\"\n          bg={theme.colors.blue[600]}\n          size=\"lg\"\n          color=\"white\"\n          aria-label=\"stop recording\"\n          onClick={stopRecording}\n          disabled={recorder ? false : true}\n          icon={<Icon as={FaVideoSlash} />}\n        />\n        <IconButton\n          bg={theme.colors.blue[600]}\n          m=\"1\"\n          size=\"lg\"\n          disabled={!!!videoBlob}\n          color=\"white\"\n          onClick={downloadVideo}\n          aria-label=\"download video\"\n          icon={<Icon as={FaDownload} />}\n        />\n      </Box>\n      <Box display=\"flex\" justifyContent=\"center\">\n        <Box\n          bg={!!videoBlob ? \"inherit\" : \"blue.50\"}\n          h=\"50vh\"\n          width={[\n            \"100%\", // 0-30em\n            \"100%\", // 30em-48em\n            \"50vw\", // 48em-62em\n            \"50vw\", // 62em+\n          ]}\n        >\n          {!!videoBlob && (\n            <Player src={window.URL.createObjectURL(videoBlob)} />\n          )}\n        </Box>\n      </Box>\n    </SimpleGrid>\n  );\n};\n\nexport default memo(MainRecorder);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}