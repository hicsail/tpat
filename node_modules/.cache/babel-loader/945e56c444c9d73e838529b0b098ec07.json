{"ast":null,"code":"/**\n * Module dependencies.\n */\nvar Stream = require('stream').Stream;\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar util = require('util');\n\nutil.inherits(gm, EventEmitter);\n/**\n * Constructor.\n *\n * @param {String|Number} path - path to img source or ReadableStream or width of img to create\n * @param {Number} [height] - optional filename of ReadableStream or height of img to create\n * @param {String} [color] - optional hex background color of created img\n */\n\nfunction gm(source, height, color) {\n  var width;\n\n  if (!(this instanceof gm)) {\n    return new gm(source, height, color);\n  }\n\n  EventEmitter.call(this);\n  this._options = {};\n  this.options(this.__proto__._options);\n  this.data = {};\n  this._in = [];\n  this._out = [];\n  this._outputFormat = null;\n  this._subCommand = 'convert';\n\n  if (source instanceof Stream) {\n    this.sourceStream = source;\n    source = height || 'unknown.jpg';\n  } else if (Buffer.isBuffer(source)) {\n    this.sourceBuffer = source;\n    source = height || 'unknown.jpg';\n  } else if (height) {\n    // new images\n    width = source;\n    source = \"\";\n    this.in(\"-size\", width + \"x\" + height);\n\n    if (color) {\n      this.in(\"xc:\" + color);\n    }\n  }\n\n  if (typeof source === \"string\") {\n    // then source is a path\n    // parse out gif frame brackets from filename\n    // since stream doesn't use source path\n    // eg. \"filename.gif[0]\"\n    var frames = source.match(/(\\[.+\\])$/);\n\n    if (frames) {\n      this.sourceFrames = source.substr(frames.index, frames[0].length);\n      source = source.substr(0, frames.index);\n    }\n  }\n\n  this.source = source;\n  this.addSrcFormatter(function (src) {\n    // must be first source formatter\n    var inputFromStdin = this.sourceStream || this.sourceBuffer;\n    var ret = inputFromStdin ? '-' : this.source;\n    if (ret && this.sourceFrames) ret += this.sourceFrames;\n    src.length = 0;\n    src[0] = ret;\n  });\n}\n/**\n * Subclasses the gm constructor with custom options.\n *\n * @param {options} options\n * @return {gm} the subclasses gm constructor\n */\n\n\nvar parent = gm;\n\ngm.subClass = function subClass(options) {\n  function gm(source, height, color) {\n    if (!(this instanceof parent)) {\n      return new gm(source, height, color);\n    }\n\n    parent.call(this, source, height, color);\n  }\n\n  gm.prototype.__proto__ = parent.prototype;\n  gm.prototype._options = {};\n  gm.prototype.options(options);\n  return gm;\n};\n/**\n * Augment the prototype.\n */\n\n\nrequire(\"./lib/options\")(gm.prototype);\n\nrequire(\"./lib/getters\")(gm);\n\nrequire(\"./lib/args\")(gm.prototype);\n\nrequire(\"./lib/drawing\")(gm.prototype);\n\nrequire(\"./lib/convenience\")(gm.prototype);\n\nrequire(\"./lib/command\")(gm.prototype);\n\nrequire(\"./lib/compare\")(gm.prototype);\n\nrequire(\"./lib/composite\")(gm.prototype);\n\nrequire(\"./lib/montage\")(gm.prototype);\n/**\n * Expose.\n */\n\n\nmodule.exports = exports = gm;\nmodule.exports.utils = require('./lib/utils');\nmodule.exports.compare = require('./lib/compare')();\nmodule.exports.version = require('./package.json').version;","map":{"version":3,"names":["Stream","require","EventEmitter","util","inherits","gm","source","height","color","width","call","_options","options","__proto__","data","_in","_out","_outputFormat","_subCommand","sourceStream","Buffer","isBuffer","sourceBuffer","in","frames","match","sourceFrames","substr","index","length","addSrcFormatter","src","inputFromStdin","ret","parent","subClass","prototype","module","exports","utils","compare","version"],"sources":["/Users/so._.may._.see._.macy/Desktop/tpat/node_modules/gm/index.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar Stream = require('stream').Stream;\nvar EventEmitter = require('events').EventEmitter;\nvar util = require('util');\n\nutil.inherits(gm, EventEmitter);\n\n/**\n * Constructor.\n *\n * @param {String|Number} path - path to img source or ReadableStream or width of img to create\n * @param {Number} [height] - optional filename of ReadableStream or height of img to create\n * @param {String} [color] - optional hex background color of created img\n */\n\nfunction gm (source, height, color) {\n  var width;\n\n  if (!(this instanceof gm)) {\n    return new gm(source, height, color);\n  }\n\n  EventEmitter.call(this);\n\n  this._options = {};\n  this.options(this.__proto__._options);\n\n  this.data = {};\n  this._in = [];\n  this._out = [];\n  this._outputFormat = null;\n  this._subCommand = 'convert';\n\n  if (source instanceof Stream) {\n    this.sourceStream = source;\n    source = height || 'unknown.jpg';\n  } else if (Buffer.isBuffer(source)) {\n    this.sourceBuffer = source;\n    source = height || 'unknown.jpg';\n  } else if (height) {\n    // new images\n    width = source;\n    source = \"\";\n\n    this.in(\"-size\", width + \"x\" + height);\n\n    if (color) {\n      this.in(\"xc:\"+ color);\n    }\n  }\n\n  if (typeof source === \"string\") {\n    // then source is a path\n\n    // parse out gif frame brackets from filename\n    // since stream doesn't use source path\n    // eg. \"filename.gif[0]\"\n    var frames = source.match(/(\\[.+\\])$/);\n    if (frames) {\n      this.sourceFrames = source.substr(frames.index, frames[0].length);\n      source = source.substr(0, frames.index);\n    }\n  }\n\n  this.source = source;\n\n  this.addSrcFormatter(function (src) {\n    // must be first source formatter\n\n    var inputFromStdin = this.sourceStream || this.sourceBuffer;\n    var ret = inputFromStdin ? '-' : this.source;\n\n    if (ret && this.sourceFrames) ret += this.sourceFrames;\n\n    src.length = 0;\n    src[0] = ret;\n  });\n}\n\n/**\n * Subclasses the gm constructor with custom options.\n *\n * @param {options} options\n * @return {gm} the subclasses gm constructor\n */\n\nvar parent = gm;\ngm.subClass = function subClass (options) {\n  function gm (source, height, color) {\n    if (!(this instanceof parent)) {\n      return new gm(source, height, color);\n    }\n\n    parent.call(this, source, height, color);\n  }\n\n  gm.prototype.__proto__ = parent.prototype;\n  gm.prototype._options = {};\n  gm.prototype.options(options);\n\n  return gm;\n}\n\n/**\n * Augment the prototype.\n */\n\nrequire(\"./lib/options\")(gm.prototype);\nrequire(\"./lib/getters\")(gm);\nrequire(\"./lib/args\")(gm.prototype);\nrequire(\"./lib/drawing\")(gm.prototype);\nrequire(\"./lib/convenience\")(gm.prototype);\nrequire(\"./lib/command\")(gm.prototype);\nrequire(\"./lib/compare\")(gm.prototype);\nrequire(\"./lib/composite\")(gm.prototype);\nrequire(\"./lib/montage\")(gm.prototype);\n\n/**\n * Expose.\n */\n\nmodule.exports = exports = gm;\nmodule.exports.utils = require('./lib/utils');\nmodule.exports.compare = require('./lib/compare')();\nmodule.exports.version = require('./package.json').version;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}