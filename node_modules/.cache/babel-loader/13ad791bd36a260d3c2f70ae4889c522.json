{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar SecurityDefense = function SecurityDefense(waterMarkStyle, getImageUrl, securityAlarm) {\n  var _this = this;\n\n  _classCallCheck(this, SecurityDefense);\n\n  this.getWaterMarkDom = function () {\n    return document.getElementById(_this.randomId);\n  };\n\n  this.registerNodeRemoveListener = function (dom, parent) {\n    dom.addEventListener('DOMNodeRemoved', function () {\n      _this.createWaterMarkDom(parent);\n\n      if (_this.securityAlarm) {\n        _this.securityAlarm();\n      }\n    }, false);\n  };\n\n  this.createWaterMarkDom = function (parent) {\n    var newWaterMark = document.createElement('div');\n    _this.randomId = 'water-mark-observer-' + new Date().getTime();\n    newWaterMark.id = _this.randomId;\n    _this.waterMarkStyle = _this.waterMarkStyle.concat('background-image: url(\"' + _this.getImageUrl() + '\");');\n    newWaterMark.style = _this.waterMarkStyle;\n    parent.appendChild(newWaterMark);\n\n    var newDom = _this.getWaterMarkDom();\n\n    _this.registerNodeRemoveListener(newDom, parent);\n\n    _this.registerNodeAttrChangeListener(newDom);\n  };\n\n  this.registerNodeAttrChangeListener = function (target) {\n    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n    var observer = new MutationObserver(function (mutations) {\n      mutations.forEach(function (mutation) {\n        if (mutation.type === 'attributes') {\n          target.parentNode.removeChild(target);\n          observer.disconnect();\n        }\n      });\n    });\n    var config = {\n      attributes: true,\n      attributeFilter: ['style']\n    };\n    observer.observe(target, config);\n  };\n\n  this.randomId = 'water-mark-observer';\n  this.waterMarkStyle = waterMarkStyle;\n  this.getImageUrl = getImageUrl;\n  this.securityAlarm = securityAlarm;\n};\n\nexports.default = SecurityDefense;\nmodule.exports = exports['default'];","map":{"version":3,"mappings":";;;;;;;;;;;;IAAqBA,e,GACnB,yBAAYC,cAAZ,EAA4BC,WAA5B,EAAyCC,aAAzC,EAAwD;EAAA;;EAAAC;;EAAA,KAOxDC,eAPwD,GAOtC,YAAM;IACtB,OAAOC,SAASC,cAATD,CAAwBE,MAAKC,QAA7BH,CAAP;EARsD;;EAAA,KAWxDI,0BAXwD,GAW3B,UAACC,GAAD,EAAMC,MAAN,EAAiB;IAC5CD,IAAIE,gBAAJF,CAAqB,gBAArBA,EAAuC,YAAM;MAC3CH,MAAKM,kBAAL,CAAwBF,MAAxB;;MACA,IAAIJ,MAAKL,aAAT,EAAwB;QACtBK,MAAKL,aAAL;MACD;IAJH,GAKG,KALHQ;EAZsD;;EAAA,KAoBxDG,kBApBwD,GAoBnC,UAACF,MAAD,EAAY;IAC/B,IAAMG,eAAeT,SAASU,aAATV,CAAuB,KAAvBA,CAArB;IACAE,MAAKC,QAAL,4BAAwC,IAAIQ,IAAJ,GAAYC,OAAZ,EAAxC;IACAH,aAAaI,EAAbJ,GAAkBP,MAAKC,QAAvBM;IACAP,MAAKP,cAAL,GAAsBO,MAAKP,cAAL,CAAoBmB,MAApB,6BAAqDZ,MAAKN,WAAL,EAArD,SAAtB;IACAa,aAAaM,KAAbN,GAAqBP,MAAKP,cAA1Bc;IACAH,OAAOU,WAAPV,CAAmBG,YAAnBH;;IACA,IAAMW,SAASf,MAAKH,eAAL,EAAf;;IACAG,MAAKE,0BAAL,CAAgCa,MAAhC,EAAwCX,MAAxC;;IACAJ,MAAKgB,8BAAL,CAAoCD,MAApC;EA7BsD;;EAAA,KAgCxDC,8BAhCwD,GAgCvB,UAACC,MAAD,EAAY;IAC3C,IAAIC,mBAAmBC,OAAOD,gBAAPC,IAA2BA,OAAOC,sBAAlCD,IAA4DA,OAAOE,mBAA1F;IACA,IAAIC,WAAW,IAAIJ,gBAAJ,CAAqB,UAACK,SAAD,EAAe;MACjDA,UAAUC,OAAVD,CAAkB,UAACE,QAAD,EAAc;QAC9B,IAAIA,SAASC,IAATD,KAAkB,YAAtB,EAAoC;UAClCR,OAAOU,UAAPV,CAAkBW,WAAlBX,CAA8BA,MAA9BA;UACAK,SAASO,UAATP;QACD;MAJH;IADa,EAAf;IAQA,IAAIQ,SAAS;MAAEC,YAAY,IAAd;MAAoBC,iBAAiB,CAAC,OAAD;IAArC,CAAb;IACAV,SAASW,OAATX,CAAiBL,MAAjBK,EAAyBQ,MAAzBR;EA3CsD;;EACtD,KAAKrB,QAAL,GAAgB,qBAAhB;EACA,KAAKR,cAAL,GAAsBA,cAAtB;EACA,KAAKC,WAAL,GAAmBA,WAAnB;EACA,KAAKC,aAAL,GAAqBA,aAArB;;;kBALiBH","names":["SecurityDefense","waterMarkStyle","getImageUrl","securityAlarm","_classCallCheck","getWaterMarkDom","document","getElementById","_this","randomId","registerNodeRemoveListener","dom","parent","addEventListener","createWaterMarkDom","newWaterMark","createElement","Date","getTime","id","concat","style","appendChild","newDom","registerNodeAttrChangeListener","target","MutationObserver","window","WebKitMutationObserver","MozMutationObserver","observer","mutations","forEach","mutation","type","parentNode","removeChild","disconnect","config","attributes","attributeFilter","observe"],"sources":["/Users/so._.may._.see._.macy/Desktop/tpat/node_modules/react-watermark-component/src/SecurityDefense.js"],"sourcesContent":["export default class SecurityDefense {\n  constructor(waterMarkStyle, getImageUrl, securityAlarm) {\n    this.randomId = 'water-mark-observer'\n    this.waterMarkStyle = waterMarkStyle\n    this.getImageUrl = getImageUrl\n    this.securityAlarm = securityAlarm\n  }\n\n  getWaterMarkDom = () => {\n    return document.getElementById(this.randomId)\n  }\n\n  registerNodeRemoveListener = (dom, parent) => {\n    dom.addEventListener('DOMNodeRemoved', () => {\n      this.createWaterMarkDom(parent)\n      if (this.securityAlarm) {\n        this.securityAlarm()\n      }\n    }, false)\n  }\n\n  createWaterMarkDom = (parent) => {\n    const newWaterMark = document.createElement('div')\n    this.randomId = `water-mark-observer-${(new Date()).getTime()}`\n    newWaterMark.id = this.randomId\n    this.waterMarkStyle = this.waterMarkStyle.concat(`background-image: url(\"${this.getImageUrl()}\");`)\n    newWaterMark.style = this.waterMarkStyle\n    parent.appendChild(newWaterMark)\n    const newDom = this.getWaterMarkDom()\n    this.registerNodeRemoveListener(newDom, parent)\n    this.registerNodeAttrChangeListener(newDom)\n  }\n\n  registerNodeAttrChangeListener = (target) => {\n    let MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver\n    var observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.type === 'attributes') {\n          target.parentNode.removeChild(target)\n          observer.disconnect()\n        }\n      })\n    })\n    let config = { attributes: true, attributeFilter: ['style'] }\n    observer.observe(target, config)\n  }\n}\n"]},"metadata":{},"sourceType":"script"}