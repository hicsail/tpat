{"ast":null,"code":"/**\n * Extend proto.\n */\nmodule.exports = function (proto) {\n  var exifTransforms = {\n    topleft: '',\n    topright: ['-flop'],\n    bottomright: ['-rotate', 180],\n    bottomleft: ['-flip'],\n    lefttop: ['-flip', '-rotate', 90],\n    righttop: ['-rotate', 90],\n    rightbottom: ['-flop', '-rotate', 90],\n    leftbottom: ['-rotate', 270]\n  };\n\n  proto.autoOrient = function autoOrient() {\n    // Always strip EXIF data since we can't\n    // change/edit it.\n    // imagemagick has a native -auto-orient option\n    // so does graphicsmagick, but in 1.3.18.\n    // nativeAutoOrient option enables this if you know you have >= 1.3.18\n    if (this._options.nativeAutoOrient || this._options.imageMagick) {\n      this.out('-auto-orient');\n      this.strip();\n      return this;\n    }\n\n    this.preprocessor(function (callback) {\n      this.orientation({\n        bufferStream: true\n      }, function (err, orientation) {\n        if (err) return callback(err);\n        var transforms = exifTransforms[orientation.toLowerCase()];\n\n        if (transforms) {\n          // remove any existing transforms that might conflict\n          var index = this._out.indexOf(transforms[0]);\n\n          if (~index) {\n            this._out.splice(index, transforms.length);\n          } // repage to fix coordinates\n\n\n          this._out.unshift.apply(this._out, transforms.concat('-page', '+0+0'));\n        }\n\n        this.strip();\n        callback();\n      });\n    });\n    return this;\n  };\n};","map":{"version":3,"names":["module","exports","proto","exifTransforms","topleft","topright","bottomright","bottomleft","lefttop","righttop","rightbottom","leftbottom","autoOrient","_options","nativeAutoOrient","imageMagick","out","strip","preprocessor","callback","orientation","bufferStream","err","transforms","toLowerCase","index","_out","indexOf","splice","length","unshift","apply","concat"],"sources":["/Users/so._.may._.see._.macy/Desktop/tpat/node_modules/gm/lib/convenience/autoOrient.js"],"sourcesContent":["\n/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n\n  var exifTransforms = {\n      topleft:     ''\n    , topright:    ['-flop']\n    , bottomright: ['-rotate', 180]\n    , bottomleft:  ['-flip']\n    , lefttop:     ['-flip', '-rotate', 90]\n    , righttop:    ['-rotate', 90]\n    , rightbottom: ['-flop', '-rotate', 90]\n    , leftbottom:  ['-rotate', 270]\n  }\n\n  proto.autoOrient = function autoOrient () {\n    // Always strip EXIF data since we can't\n    // change/edit it.\n\n    // imagemagick has a native -auto-orient option\n    // so does graphicsmagick, but in 1.3.18.\n    // nativeAutoOrient option enables this if you know you have >= 1.3.18\n    if (this._options.nativeAutoOrient || this._options.imageMagick) {\n      this.out('-auto-orient');\n      this.strip();\n      return this;\n    }\n\n    this.preprocessor(function (callback) {\n      this.orientation({bufferStream: true}, function (err, orientation) {\n        if (err) return callback(err);\n\n        var transforms = exifTransforms[orientation.toLowerCase()];\n        if (transforms) {\n\n          // remove any existing transforms that might conflict\n          var index = this._out.indexOf(transforms[0]);\n          if (~index) {\n            this._out.splice(index, transforms.length);\n          }\n\n          // repage to fix coordinates\n          this._out.unshift.apply(this._out, transforms.concat('-page', '+0+0'));\n        }\n\n        this.strip();\n\n        callback();\n      });\n    });\n\n    return this;\n  }\n}\n"],"mappings":"AACA;AACA;AACA;AAEAA,MAAM,CAACC,OAAP,GAAiB,UAAUC,KAAV,EAAiB;EAEhC,IAAIC,cAAc,GAAG;IACjBC,OAAO,EAAM,EADI;IAEjBC,QAAQ,EAAK,CAAC,OAAD,CAFI;IAGjBC,WAAW,EAAE,CAAC,SAAD,EAAY,GAAZ,CAHI;IAIjBC,UAAU,EAAG,CAAC,OAAD,CAJI;IAKjBC,OAAO,EAAM,CAAC,OAAD,EAAU,SAAV,EAAqB,EAArB,CALI;IAMjBC,QAAQ,EAAK,CAAC,SAAD,EAAY,EAAZ,CANI;IAOjBC,WAAW,EAAE,CAAC,OAAD,EAAU,SAAV,EAAqB,EAArB,CAPI;IAQjBC,UAAU,EAAG,CAAC,SAAD,EAAY,GAAZ;EARI,CAArB;;EAWAT,KAAK,CAACU,UAAN,GAAmB,SAASA,UAAT,GAAuB;IACxC;IACA;IAEA;IACA;IACA;IACA,IAAI,KAAKC,QAAL,CAAcC,gBAAd,IAAkC,KAAKD,QAAL,CAAcE,WAApD,EAAiE;MAC/D,KAAKC,GAAL,CAAS,cAAT;MACA,KAAKC,KAAL;MACA,OAAO,IAAP;IACD;;IAED,KAAKC,YAAL,CAAkB,UAAUC,QAAV,EAAoB;MACpC,KAAKC,WAAL,CAAiB;QAACC,YAAY,EAAE;MAAf,CAAjB,EAAuC,UAAUC,GAAV,EAAeF,WAAf,EAA4B;QACjE,IAAIE,GAAJ,EAAS,OAAOH,QAAQ,CAACG,GAAD,CAAf;QAET,IAAIC,UAAU,GAAGpB,cAAc,CAACiB,WAAW,CAACI,WAAZ,EAAD,CAA/B;;QACA,IAAID,UAAJ,EAAgB;UAEd;UACA,IAAIE,KAAK,GAAG,KAAKC,IAAL,CAAUC,OAAV,CAAkBJ,UAAU,CAAC,CAAD,CAA5B,CAAZ;;UACA,IAAI,CAACE,KAAL,EAAY;YACV,KAAKC,IAAL,CAAUE,MAAV,CAAiBH,KAAjB,EAAwBF,UAAU,CAACM,MAAnC;UACD,CANa,CAQd;;;UACA,KAAKH,IAAL,CAAUI,OAAV,CAAkBC,KAAlB,CAAwB,KAAKL,IAA7B,EAAmCH,UAAU,CAACS,MAAX,CAAkB,OAAlB,EAA2B,MAA3B,CAAnC;QACD;;QAED,KAAKf,KAAL;QAEAE,QAAQ;MACT,CAnBD;IAoBD,CArBD;IAuBA,OAAO,IAAP;EACD,CArCD;AAsCD,CAnDD"},"metadata":{},"sourceType":"script"}