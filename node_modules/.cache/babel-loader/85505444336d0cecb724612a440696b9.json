{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mannysa/SAIL projects/tpat/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mannysa/SAIL projects/tpat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mannysa/SAIL projects/tpat/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import CountDownTimer from\"../components/Timer\";import{useRecordWebcam,CAMERA_STATUS}from\"react-record-webcam\";import{useNavigate}from\"react-router-dom\";import Modal from\"react-modal\";import{uploadTos3}from\"../utils/videoUploadUtils\";import{UserContext}from\"../store/UserContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";Modal.setAppElement(\"#root\");var OPTIONS={filename:\"video\",fileType:\"webm\",codec:{audio:\"aac\"|\"opus\",video:\"av1\"|\"avc\"|\"vp8\"},width:1920,height:1080};function Tutorial2(){var hoursMinSecs={minutes:7,seconds:2};var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isRecord=_useState2[0],setRecord=_useState2[1];var recordWebcam=useRecordWebcam(OPTIONS);var _useContext=useContext(UserContext),user=_useContext.user;var navigate=useNavigate();var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOpen=_useState4[0],setIsOpen=_useState4[1];function toggleModal(){setIsOpen(!isOpen);}useEffect(function(){// opening the camera\nsetTimeout(function(){if(recordWebcam.status===CAMERA_STATUS.CLOSED){recordWebcam.open();}//1 second = 1000 millisecond\n},1000);// page timer itself, navigate back at 7 mins 5 seconds when camera is recording\nsetTimeout(function(){navigate(\"/\");//1 second = 1000 millisecond\n},425000);// video timer itself, stops at 7 mins\nif(recordWebcam.status===CAMERA_STATUS.RECORDING){setTimeout(function(){recordWebcam.stop();//recordWebcam.getRecording();\n//1 second = 1000 millisecond\n},421000);}if(recordWebcam.status===CAMERA_STATUS.PREVIEW){setTimeout(function(){navigate(\"/\");//1 second = 1000 millisecond\n},1000);recordWebcam.close();// recordWebcam.download();\nuploadTask(recordWebcam);}});function uploadTask(_x){return _uploadTask.apply(this,arguments);}function _uploadTask(){_uploadTask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(recordWebcam){var blob,metadata;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return recordWebcam.getRecording();case 2:blob=_context.sent;metadata={name:user.name,email:user.email,taskId:\"1.1\"};uploadTos3(blob,metadata);case 5:case\"end\":return _context.stop();}}},_callee);}));return _uploadTask.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{style:{marginLeft:\"5%\",paddingTop:\"3%\",marginRight:\"5%\"},children:[/*#__PURE__*/_jsx(\"button\",{class:\"instructionBtn\",onClick:toggleModal,children:\"Click to see Instructions\"}),/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onRequestClose:toggleModal,contentLabel:\"My dialog\",className:\"mymodal\",overlayClassName:\"myoverlay\",closeTimeoutMS:500,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Timer on the task\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your camera will automatically start and open when you get onto the page / auto-directed to the page. Once you are on the page, your camera will automatically open, and start recording shortly after. You will also be able to see the timer starting to count down. The video will stop after the task timer/timer runs out, but you are also able to stop recording once you are finished. The video will automatically download to your local computer, and redirect you back to the homepage.\"})]}),/*#__PURE__*/_jsx(\"button\",{class:\"closerBtn\",onClick:toggleModal,children:\"Close modal\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Camera status: \",recordWebcam.status]}),recordWebcam.status===CAMERA_STATUS.RECORDING?/*#__PURE__*/_jsx(CountDownTimer,{hoursMinSecs:hoursMinSecs}):/*#__PURE__*/_jsx(\"p\",{children:\"Time Limit: 7 minutes\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"webcam\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:recordWebcam.status===CAMERA_STATUS.OPEN||recordWebcam.status===CAMERA_STATUS.RECORDING||recordWebcam.status===CAMERA_STATUS.PREVIEW,onClick:recordWebcam.open,children:\"Open camera\"}),/*#__PURE__*/_jsx(\"button\",{disabled:recordWebcam.status===CAMERA_STATUS.CLOSED||recordWebcam.status===CAMERA_STATUS.RECORDING||recordWebcam.status===CAMERA_STATUS.PREVIEW,onClick:function onClick(){recordWebcam.start();setRecord(!isRecord);},children:\"Start recording\"}),/*#__PURE__*/_jsx(\"button\",{disabled:recordWebcam.status!==CAMERA_STATUS.RECORDING,onClick:function onClick(){recordWebcam.stop();setRecord(!isRecord);},children:\"Stop recording\"})]}),/*#__PURE__*/_jsx(\"video\",{ref:recordWebcam.webcamRef,style:{display:\"\".concat(recordWebcam.status===CAMERA_STATUS.OPEN||recordWebcam.status===CAMERA_STATUS.RECORDING?\"block\":\"none\")},autoPlay:true,muted:true}),/*#__PURE__*/_jsx(\"video\",{ref:recordWebcam.previewRef,style:{display:\"\".concat(recordWebcam.status===CAMERA_STATUS.PREVIEW?\"block\":\"none\")},controls:true})]});}export default Tutorial2;","map":{"version":3,"names":["React","useState","useEffect","useContext","CountDownTimer","useRecordWebcam","CAMERA_STATUS","useNavigate","Modal","uploadTos3","UserContext","setAppElement","OPTIONS","filename","fileType","codec","audio","video","width","height","Tutorial2","hoursMinSecs","minutes","seconds","isRecord","setRecord","recordWebcam","user","navigate","isOpen","setIsOpen","toggleModal","setTimeout","status","CLOSED","open","RECORDING","stop","PREVIEW","close","uploadTask","getRecording","blob","metadata","name","email","taskId","marginLeft","paddingTop","marginRight","OPEN","start","webcamRef","display","previewRef"],"sources":["/Users/mannysa/SAIL projects/tpat/src/pages/tutorial2.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport CountDownTimer from \"../components/Timer\";\nimport { useRecordWebcam, CAMERA_STATUS } from \"react-record-webcam\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport Modal from \"react-modal\";\nimport { uploadTos3 } from \"../utils/videoUploadUtils\";\nimport { UserContext } from \"../store/UserContext\";\n\nModal.setAppElement(\"#root\");\n\nconst OPTIONS = {\n  filename: \"video\",\n  fileType: \"webm\",\n  codec: { audio: \"aac\" | \"opus\", video: \"av1\" | \"avc\" | \"vp8\" },\n  width: 1920,\n  height: 1080,\n};\n\nfunction Tutorial2() {\n  const hoursMinSecs = { minutes: 7, seconds: 2 };\n  const [isRecord, setRecord] = useState(false);\n  const recordWebcam = useRecordWebcam(OPTIONS);\n  const { user } = useContext(UserContext);\n\n  const navigate = useNavigate();\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  function toggleModal() {\n    setIsOpen(!isOpen);\n  }\n\n  useEffect(() => {\n    // opening the camera\n    setTimeout(() => {\n      if (recordWebcam.status === CAMERA_STATUS.CLOSED) {\n        recordWebcam.open();\n      }\n      //1 second = 1000 millisecond\n    }, 1000);\n\n    // page timer itself, navigate back at 7 mins 5 seconds when camera is recording\n    setTimeout(() => {\n      navigate(\"/\");\n      //1 second = 1000 millisecond\n    }, 425000);\n\n    // video timer itself, stops at 7 mins\n    if (recordWebcam.status === CAMERA_STATUS.RECORDING) {\n      setTimeout(() => {\n        recordWebcam.stop();\n        //recordWebcam.getRecording();\n        //1 second = 1000 millisecond\n      }, 421000);\n    }\n    if (recordWebcam.status === CAMERA_STATUS.PREVIEW) {\n      setTimeout(() => {\n        navigate(\"/\");\n        //1 second = 1000 millisecond\n      }, 1000);\n      recordWebcam.close();\n      // recordWebcam.download();\n\n      uploadTask(recordWebcam);\n    }\n  });\n\n  async function uploadTask(recordWebcam) {\n    const blob = await recordWebcam.getRecording();\n    const metadata = {\n      name: user.name,\n      email: user.email,\n      taskId: \"1.1\",\n    };\n    uploadTos3(blob, metadata);\n  }\n\n  return (\n    <div style={{ marginLeft: \"5%\", paddingTop: \"3%\", marginRight: \"5%\" }}>\n      <button class=\"instructionBtn\" onClick={toggleModal}>\n        Click to see Instructions\n      </button>\n      <Modal\n        isOpen={isOpen}\n        onRequestClose={toggleModal}\n        contentLabel=\"My dialog\"\n        className=\"mymodal\"\n        overlayClassName=\"myoverlay\"\n        closeTimeoutMS={500}\n      >\n        <div>\n          <h2>Timer on the task</h2>\n          <p>\n            Your camera will automatically start and open when you get onto the\n            page / auto-directed to the page. Once you are on the page, your\n            camera will automatically open, and start recording shortly after.\n            You will also be able to see the timer starting to count down. The\n            video will stop after the task timer/timer runs out, but you are\n            also able to stop recording once you are finished. The video will\n            automatically download to your local computer, and redirect you back\n            to the homepage.\n          </p>\n        </div>\n        <button class=\"closerBtn\" onClick={toggleModal}>\n          Close modal\n        </button>\n      </Modal>\n      <p>Camera status: {recordWebcam.status}</p>\n      {recordWebcam.status === CAMERA_STATUS.RECORDING ? (\n        <CountDownTimer hoursMinSecs={hoursMinSecs} />\n      ) : (\n        <p>Time Limit: 7 minutes</p>\n      )}\n\n      <div class=\"webcam\">\n        <button\n          disabled={\n            recordWebcam.status === CAMERA_STATUS.OPEN ||\n            recordWebcam.status === CAMERA_STATUS.RECORDING ||\n            recordWebcam.status === CAMERA_STATUS.PREVIEW\n          }\n          onClick={recordWebcam.open}\n        >\n          Open camera\n        </button>\n        <button\n          disabled={\n            recordWebcam.status === CAMERA_STATUS.CLOSED ||\n            recordWebcam.status === CAMERA_STATUS.RECORDING ||\n            recordWebcam.status === CAMERA_STATUS.PREVIEW\n          }\n          onClick={() => {\n            recordWebcam.start();\n            setRecord(!isRecord);\n          }}\n        >\n          Start recording\n        </button>\n        <button\n          disabled={recordWebcam.status !== CAMERA_STATUS.RECORDING}\n          onClick={() => {\n            recordWebcam.stop();\n            setRecord(!isRecord);\n          }}\n        >\n          Stop recording\n        </button>\n      </div>\n      <video\n        ref={recordWebcam.webcamRef}\n        style={{\n          display: `${\n            recordWebcam.status === CAMERA_STATUS.OPEN ||\n            recordWebcam.status === CAMERA_STATUS.RECORDING\n              ? \"block\"\n              : \"none\"\n          }`,\n        }}\n        autoPlay\n        muted\n      />\n      <video\n        ref={recordWebcam.previewRef}\n        style={{\n          display: `${\n            recordWebcam.status === CAMERA_STATUS.PREVIEW ? \"block\" : \"none\"\n          }`,\n        }}\n        controls\n      />\n    </div>\n  );\n}\n\nexport default Tutorial2;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}