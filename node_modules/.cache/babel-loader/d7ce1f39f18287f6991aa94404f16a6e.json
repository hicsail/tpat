{"ast":null,"code":"/**\n * Module dependencies.\n */\nvar fs = require('fs');\n\nvar parallel = require('array-parallel');\n/**\n * Extend proto.\n */\n\n\nmodule.exports = function (proto) {\n  /**\n   * Do nothing.\n   */\n  function noop() {} // http://www.graphicsmagick.org/GraphicsMagick.html#details-morph\n\n\n  proto.morph = function morph(other, outname, callback) {\n    if (!outname) {\n      throw new Error(\"an output filename is required\");\n    }\n\n    callback = (callback || noop).bind(this);\n    var self = this;\n\n    if (Array.isArray(other)) {\n      other.forEach(function (img) {\n        self.out(img);\n      });\n      self.out(\"-morph\", other.length);\n    } else {\n      self.out(other, \"-morph\", 1);\n    }\n\n    self.write(outname, function (err, stdout, stderr, cmd) {\n      if (err) return callback(err, stdout, stderr, cmd); // Apparently some platforms create the following temporary files.\n      // Check if the output file exists, if it doesn't, then\n      // work with temporary files.\n\n      fs.exists(outname, function (exists) {\n        if (exists) return callback(null, stdout, stderr, cmd);\n        parallel([fs.unlink.bind(fs, outname + '.0'), fs.unlink.bind(fs, outname + '.2'), fs.rename.bind(fs, outname + '.1', outname)], function (err) {\n          callback(err, stdout, stderr, cmd);\n        });\n      });\n    });\n    return self;\n  };\n};","map":{"version":3,"names":["fs","require","parallel","module","exports","proto","noop","morph","other","outname","callback","Error","bind","self","Array","isArray","forEach","img","out","length","write","err","stdout","stderr","cmd","exists","unlink","rename"],"sources":["/Users/so._.may._.see._.macy/Desktop/tpat/node_modules/gm/lib/convenience/morph.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar fs = require('fs');\nvar parallel = require('array-parallel');\n\n/**\n * Extend proto.\n */\n\nmodule.exports = function (proto) {\n\n  /**\n   * Do nothing.\n   */\n\n  function noop () {}\n\n  // http://www.graphicsmagick.org/GraphicsMagick.html#details-morph\n  proto.morph = function morph (other, outname, callback) {\n    if (!outname) {\n      throw new Error(\"an output filename is required\");\n    }\n\n    callback = (callback || noop).bind(this)\n\n    var self = this;\n\n    if (Array.isArray(other)) {\n      other.forEach(function (img) {\n        self.out(img);\n      });\n      self.out(\"-morph\", other.length);\n    } else {\n      self.out(other, \"-morph\", 1);\n    }\n\n    self.write(outname, function (err, stdout, stderr, cmd) {\n      if (err) return callback(err, stdout, stderr, cmd);\n\n      // Apparently some platforms create the following temporary files.\n      // Check if the output file exists, if it doesn't, then\n      // work with temporary files.\n      fs.exists(outname, function (exists) {\n        if (exists) return callback(null, stdout, stderr, cmd);\n\n        parallel([\n          fs.unlink.bind(fs, outname + '.0'),\n          fs.unlink.bind(fs, outname + '.2'),\n          fs.rename.bind(fs, outname + '.1', outname)\n        ], function (err) {\n          callback(err, stdout, stderr, cmd);\n        })\n      })\n    });\n\n    return self;\n  }\n}\n"],"mappings":"AACA;AACA;AACA;AAEA,IAAIA,EAAE,GAAGC,OAAO,CAAC,IAAD,CAAhB;;AACA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,gBAAD,CAAtB;AAEA;AACA;AACA;;;AAEAE,MAAM,CAACC,OAAP,GAAiB,UAAUC,KAAV,EAAiB;EAEhC;AACF;AACA;EAEE,SAASC,IAAT,GAAiB,CAAE,CANa,CAQhC;;;EACAD,KAAK,CAACE,KAAN,GAAc,SAASA,KAAT,CAAgBC,KAAhB,EAAuBC,OAAvB,EAAgCC,QAAhC,EAA0C;IACtD,IAAI,CAACD,OAAL,EAAc;MACZ,MAAM,IAAIE,KAAJ,CAAU,gCAAV,CAAN;IACD;;IAEDD,QAAQ,GAAG,CAACA,QAAQ,IAAIJ,IAAb,EAAmBM,IAAnB,CAAwB,IAAxB,CAAX;IAEA,IAAIC,IAAI,GAAG,IAAX;;IAEA,IAAIC,KAAK,CAACC,OAAN,CAAcP,KAAd,CAAJ,EAA0B;MACxBA,KAAK,CAACQ,OAAN,CAAc,UAAUC,GAAV,EAAe;QAC3BJ,IAAI,CAACK,GAAL,CAASD,GAAT;MACD,CAFD;MAGAJ,IAAI,CAACK,GAAL,CAAS,QAAT,EAAmBV,KAAK,CAACW,MAAzB;IACD,CALD,MAKO;MACLN,IAAI,CAACK,GAAL,CAASV,KAAT,EAAgB,QAAhB,EAA0B,CAA1B;IACD;;IAEDK,IAAI,CAACO,KAAL,CAAWX,OAAX,EAAoB,UAAUY,GAAV,EAAeC,MAAf,EAAuBC,MAAvB,EAA+BC,GAA/B,EAAoC;MACtD,IAAIH,GAAJ,EAAS,OAAOX,QAAQ,CAACW,GAAD,EAAMC,MAAN,EAAcC,MAAd,EAAsBC,GAAtB,CAAf,CAD6C,CAGtD;MACA;MACA;;MACAxB,EAAE,CAACyB,MAAH,CAAUhB,OAAV,EAAmB,UAAUgB,MAAV,EAAkB;QACnC,IAAIA,MAAJ,EAAY,OAAOf,QAAQ,CAAC,IAAD,EAAOY,MAAP,EAAeC,MAAf,EAAuBC,GAAvB,CAAf;QAEZtB,QAAQ,CAAC,CACPF,EAAE,CAAC0B,MAAH,CAAUd,IAAV,CAAeZ,EAAf,EAAmBS,OAAO,GAAG,IAA7B,CADO,EAEPT,EAAE,CAAC0B,MAAH,CAAUd,IAAV,CAAeZ,EAAf,EAAmBS,OAAO,GAAG,IAA7B,CAFO,EAGPT,EAAE,CAAC2B,MAAH,CAAUf,IAAV,CAAeZ,EAAf,EAAmBS,OAAO,GAAG,IAA7B,EAAmCA,OAAnC,CAHO,CAAD,EAIL,UAAUY,GAAV,EAAe;UAChBX,QAAQ,CAACW,GAAD,EAAMC,MAAN,EAAcC,MAAd,EAAsBC,GAAtB,CAAR;QACD,CANO,CAAR;MAOD,CAVD;IAWD,CAjBD;IAmBA,OAAOX,IAAP;EACD,CAtCD;AAuCD,CAhDD"},"metadata":{},"sourceType":"script"}